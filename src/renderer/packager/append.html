<!-- This file is appended to the end of the packager HTML inside its <iframe> -->
<!-- We use it to implement desktop integration -->
<script>
  window.addEventListener('message', (e) => {
    if (e.data.type === 'load-project') {
      const {data, name} = e.data;

      const fileTypeRadio = document.querySelector('input[type=radio][value=file]');
      fileTypeRadio.click();

      const file = new File([data], `${name}.sb3`);
      const dataTransfer = new DataTransfer();
      dataTransfer.items.add(file);

      const fileInput = document.querySelector('input[type=file]');
      fileInput.files = dataTransfer.files;
      fileInput.dispatchEvent(new Event('change'));
    }
  });
</script>
